---
title: "Absenteeism-at-work"
subtitle: "Analysis of how different factors affect absenteeism at work"
author: "The absentbees <br> Niamh Wexelstein, Jason Gunn, Samuel Buxton, Xuyan Wang"
institute: "University of Edinburgh"
date: "`r Sys.Date()`" 
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
    lib_dir: libs
    seal: false 
    nature:
      ratio: "16:9"
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false

---
```{r load-packages, include = FALSE}
# Add any additional packages you need to this chunk
library(tidyverse)
library(tidymodels)
library(knitr)
library(xaringanthemer)
```

```{r setup, include=FALSE}
# For better figure resolution
knitr::opts_chunk$set(fig.retina = 3, dpi = 300, fig.width = 6, fig.asp = 0.618, out.width = "80%")
```

```{r load-data, include=FALSE}
absenteeism <- read_csv("C:/Users/jasgu/Documents/.Uni Stuff Ig/IDS project/Project-weNotHere/Data/Absenteesim At Work.csv")
```

```{r include=FALSE}
style_xaringan(
  title_slide_background_image = "presentation.title.jpeg"
)
```

class: title-slide, top, left, inverse

.pull-left[

]

.pull-right[
# **`r rmarkdown::metadata$title`**
## **`r rmarkdown::metadata$subtitle`**
### `r rmarkdown::metadata$author`
### `r rmarkdown::metadata$institute`
### `r Sys.Date()`
]

---

## What are we going to do?

We are analysing the different factors that affect people being absent from work. We thought this would be interesting to look at because the majority of us will get employed one day and we wish to know the 
different factors that are likely to affect our enthusiasm to turn up to work.


---

# Hypothesis

We are going to analyse 3 variables in particular. We think that the further you are from work, the more children you have, and the lower your education makes you more likely to be absent from work.


---
#Our dataset

```{r glimpse, out.width = "20%", out.height = "20%", echo = FALSE}
head(absenteeism, 10)
```

---
# Cleaning the dataset

```{r Cleaning, eval = TRUE }

# Getting rid of unneeded/unwanted variables 
absenteeism <- select(absenteeism, -c(Reason_for_absence, Hit_target, Disciplinary_failure) ) 
absenteeism <- filter(absenteeism, Month_of_absence != 0)
absenteeism$Day_of_the_week <- absenteeism$Day_of_the_week -1  # Changing days of the week to 1 = Monday, 5 = Friday
colnames(absenteeism)[colnames(absenteeism) == "Son"] <- "Children"
absenteeism
```

---

#Methods

* We removed the variables "reason for absence", "hit target" and "disciplinary failure" as they aren't relevant to the purpose of our report
* box plot of some data such as "age" and "absenteesim time in hours"
* finding averages of some interesting variables by statistical method
* logistic regression model to find a linear relationship between different variables. (set Absenteesim hours as y for our models)
---
class: middle, inverse

#Introductory plots

---
##Average absenteeism split by different variables
```{r warning = FALSE, out.width = "70%", out.height = "70%", echo = FALSE, fig.align = "centre"}
ggplot(data = absenteeism, aes(x = Education, y = Absenteeism_time_in_hours)) +
  geom_boxplot() + 
  facet_wrap(~ Education) +
  ylim(0, 75) +
  labs(title = "Absenteeism time based on education level", 
       x = "Education level",
       y = "absenteeism time (hours)") +
  coord_flip() 


```

---

```{r social factors}
absenteeism_social <- absenteeism %>%
  select(Education, Children, Social_drinker, Social_smoker, Pet, Absenteeism_time_in_hours)
absenteeism_social
```

---

```{r biological factors}
absenteeism_biological<- absenteeism %>%
  select(Age, Weight, Height, Body_mass_index, Absenteeism_time_in_hours)
absenteeism_biological
```

---

```{r time-based factors}
absenteeism_time <- absenteeism %>%
  select(Month_of_absence, Day_of_the_week, Seasons, Service_time, Absenteeism_time_in_hours)
absenteeism_time
```

---

```{r geographical factors}
absenteeism_geog <- absenteeism %>%
  select(Transportation_expense, Distance_from_Residence_to_Work, Absenteeism_time_in_hours)
absenteeism_geog
```

---

```{r geographical linear regression}
geog_fit <- linear_reg() %>%
  set_engine("lm") %>%
  fit(Absenteeism_time_in_hours ~ Transportation_expense + Distance_from_Residence_to_Work, data = absenteeism_geog) 
geog_fit
```

---

```{r}
ggplot(data = absenteeism_geog, aes(x =  Distance_from_Residence_to_Work, y = Absenteeism_time_in_hours)) + 
  geom_point() 

geog_fit_aug <- augment(geog_fit$fit)
```

---

```{r}
ggplot(geog_fit_aug, mapping = aes(x = .fitted, y = .resid)) +
  geom_point(alpha = 0.5) +
  geom_hline(yintercept = 0, color = "gray", lty = "dashed") +
  labs(x = "Predicted height", y = "Residuals")
```

```


