# Absenteeism at work
======================
## By we are not here

# Introduction
Our group is doing Absenteeism at work, because we believe majority of us will work in the future, and it will be interesting for us to investigate on different aspects of being absence
We got our data set from website 'Kaggle' which they got from 'UCI machine learning repository'. The link is following: 'https://archive.ics.uci.edu/ml/datasets/Absenteeism+at+work'. There are 21 variables and 740 observations.

```{r load-data, include=FALSE}
absenteeism <- read_csv("C:/Users/jasgu/Documents/.Uni Stuff Ig/IDS project/Project-weNotHere/Data/Absenteesim At Work.csv")
```
```{r glimpse, out.width = "20%", out.height = "20%", echo = FALSE}
head(absenteeism, 10)
```

# Cleaning our data
Cleaning our data set is our first step. We have deleted some of the variables, Reason for absence, Hit target, Disciplinary failure, because for 'Reason for absence' we believe it is not important to know why people are absent, as it just happened. For 'Hit Target' we are not really sure about what it is, so we just deleted it from our data set. For 'Disciplinary failure' we do not really think this is a point worth investigation, so we just get rid of this variable.

```{r}
# Getting rid of unneeded/unwanted variables 
absenteeism <- select(absenteeism, -c(Reason_for_absence, Hit_target, Disciplinary_failure) ) 
```
We also find it may be useful to get rid of the people with 0 hours of absenteeism, becuase we are only interested in people who are late.
```{r}
absenteeism <- filter(absenteeism, Absenteeism_time_in_hours != 0)
absenteeism
```

After deleting our variables, we change the name of the column called 'Son' to children as this is more representative. Also we modified the variable 'Day of the Week' as at beginning Monday was two, Friday was six, to make more sense, we changed to Monday as one and Friday as five, etc. 

```{r}
absenteeism <- filter(absenteeism, Month_of_absence != 0)
absenteeism$Day_of_the_week <- absenteeism$Day_of_the_week -1  # Changing days of the week to 1 = Monday, 5 = Friday
colnames(absenteeism)[colnames(absenteeism) == "Son"] <- "Children"
```
In the end we split the data set into several groups. 

# Details of spliting data set.
We first created a group called Social, which basically includes all social factors which cause people to be absent, which are Education, Children, Social drinker, Social smoker, Pet, Absenteeism time in hours.
```{r social factors}
absenteeism_social <- absenteeism %>%
  select(Education, Children, Social_drinker, Social_smoker, Pet, Absenteeism_time_in_hours)
absenteeism_social
```
Then we created a group called Biological, which includes details for human body, Age, Weight, Height, Body mass index, Absenteeism time in hours.
```{r biological factors}
absenteeism_biological<- absenteeism %>%
  select(Age, Weight, Height, Body_mass_index, Absenteeism_time_in_hours)
absenteeism_biological
```
Then our third group is called time, which have all the variables that are time related. Month of absence, Day of the week, Seasons, Service time, Absenteeism time in hours.
```{r time-based factors}
absenteeism_time <- absenteeism %>%
  select(Month_of_absence, Day_of_the_week, Seasons, Service_time, Absenteeism_time_in_hours)
absenteeism_time
```
In the end we have a group called Geog, which is related to geographical variables, Transportation expense, Distance from Residence to Work, Absenteeism time in hours
```{r geographical factors}
absenteeism_geog <- absenteeism %>%
  select(Transportation_expense, Distance_from_Residence_to_Work, Absenteeism_time_in_hours)
absenteeism_geog
```

# Hypothesis
Our group was firstly interested in Social, we are specifically interested in education level and absenteeism hours. Our hypothesis is such that the higher your education level, the less you will be absent. Which is pretty obvious,  people tend to be more punctual as they receive more education.

# Method
To test our hypothesis, we tried to do a box plot, so that we can see the difference with four different education level. Before we do our box plot we are also going to find out the number of people in each education level, because if the number frame is not large enough the result will not be representative enough. We use box plot because we are able to see median, maximum, minimum of the hours of absenteeism of people. We did faceting in order to put these four levels together to make our table tidy. In the end we restricted the limit, because there are to many outliers for people with education level one.

```{r warning = FALSE, out.width = "70%", out.height = "70%", echo = FALSE, fig.align = "centre"}
ggplot(data = absenteeism, aes(x = Education, y = Absenteeism_time_in_hours)) +
  geom_boxplot() + 
  facet_wrap(~ Education) +
  ylim(0, 75) +
  labs(title = "Absenteeism time based on education level", 
       x = "Education level",
       y = "absenteeism time (hours)") +
  coord_flip() 

educ <- select(absenteeism, Education)
educ_4 <- filter(educ, Education == 4)
nrow(educ_4)
educ_3 <- filter(educ, Education == 3)
nrow(educ_3)
educ_2 <- filter(educ, Education == 2)
nrow(educ_2)
educ_1 <- filter(educ, Education == 1)
nrow(educ_1)


```

# Observations
Surprisingly there are only four people with education level four. There are 608 people with education level 1, which is over 82 percent of the total number of people participated. Meanwhile Education level four has the smallest range. Education level two and three have similar amount of people, which are 79 and 46 respectively. 

# Analysis
There are absolutely 0 outliers for education level four, which we think is because the number of people with education level four is too small, and the reason for so many outliers for education level four is because there are too many people with that education level. Now we can also concludes that majority of people participated the investigation are people with education level one there are not that much people with education level two and over. To summaries, we believe it is better to eliminate people with education level four. To conclude our hypothesis, we think that people with education level one is more punctual, which is totally opposite to our hypothesis, we guess the reason behind this is that people with education level one is less competitive in the employment market, so that they want to work harder to maintain their job.

# Hypothesis
After social, we did geographical factors, our hypothesis is that further away you live from where you work ends up with more absenteeism in hours. Which is easy to think about, because as it is further from where you work  it is higher to estimate the amount of time to get to work. For example that if you are taking bus to work and all the traffic lights are red when you want to pass, you have to wait until it is green and it will take much longer time than if all traffic lights are green. Also we suppose that if the distance is long, people will take transportation to work, and if there is a traffic jam, it will lead to a severe lateness. We also consider that transportation expense will be linked with absenteeism hours as well.

# Method
We did a linear regression first, because we have two numerical variables, we assume that absenteeism time in hours is some how linked to transportation expense plus distance from residence to work.
```{r geographical linear regression}
geog_fit <- linear_reg() %>%
  set_engine("lm") %>%
  fit(Absenteeism_time_in_hours ~ Transportation_expense + Distance_from_Residence_to_Work, data = absenteeism_geog) 
geog_fit

ggplot() +
  geom_point(data = absenteeism_geog, aes( x = Transportation_expense + Distance_from_Residence_to_Work, y = Absenteeism_time_in_hours ))


```
After linear regression we believe it is good to do a residual plot in order to see how good the linear model fits the data we have.
```{r}
geog_fit_aug <- augment(geog_fit$fit)

ggplot(geog_fit_aug, mapping = aes(x = .fitted, y = .resid)) +
  geom_point(alpha = 0.5) +
  geom_hline(yintercept = 0, color = "gray", lty = "dashed") +
  labs(x = "Predicted height", y = "Residuals")
```

# Observation
The further away from where we live, the less hours of absenteeism will be, and the residual graph is not really random enough, so we assume it is better to do a log based one again.

# Method 
This time we do log(absenteeism time in hours), and see what is the new observation.
```{r geographical linear regression}
geog_fit_log <- linear_reg() %>%
  set_engine("lm") %>%
  fit(log(Absenteeism_time_in_hours) ~ Transportation_expense + Distance_from_Residence_to_Work, data = absenteeism_geog) 
geog_fit_log

ggplot() +
  geom_point(data = absenteeism_geog, aes( x = Transportation_expense + Distance_from_Residence_to_Work, y = log(Absenteeism_time_in_hours ) ))
```

# Analysis
Firstly we did linear regression model without logarithms and the result seems to be a bit unreal, we can explain why this does not fit our expectation, such as people that live further tend to leave their house to work earlier, so that they will not be absent, however the graph itself looks pretty nonsense as all the points just gathered at the x axis, meanwhile the residual plot is not random enough as well. The residual plot shows how well the linear model fits the data, to be a good linear regression model, we wants the residual plot to be random. After the fail in the linear regression model, we decided to change the absenteeism time in hour into log based, the we found out that the graph makes more sense, althogh the points seem to be random, there is some kind of regression in it.
